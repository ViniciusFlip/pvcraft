<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-98NKC0R6NN"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-98NKC0R6NN');
    </script>
     <script src="/seo-generator.js"></script>
    <!-- Metadados básicos -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary Meta Tags -->
    <title>MCPE Maps | Download Best Minecraft Bedrock Maps - PVCRAFT</title>
    <meta name="description" content="Download free MCPE Maps for Minecraft Bedrock Edition. Adventure maps, parkour maps, survival maps, puzzle maps and more for Minecraft Pocket Edition.">
    <meta name="keywords" content="mcpe maps, minecraft bedrock maps, minecraft pe maps, free minecraft maps, adventure maps, parkour maps, survival maps, puzzle maps, download minecraft maps">
    <meta name="author" content="PVCRAFT">
    <meta name="robots" content="index, follow, max-image-preview:large">
    <meta name="theme-color" content="#6cc349">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.pvcraft.net/maps/">
    <meta property="og:title" content="MCPE Maps | Download Best Minecraft Bedrock Maps - PVCRAFT">
    <meta property="og:description" content="Download free MCPE Maps for Minecraft Bedrock Edition. Adventure maps, parkour maps, survival maps, puzzle maps and more.">
    <meta property="og:image" content="https://www.pvcraft.net/home/imgs/home.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://www.pvcraft.net/maps/">
    <meta property="twitter:title" content="MCPE Maps | Download Best Minecraft Bedrock Maps - PVCRAFT">
    <meta property="twitter:description" content="Download free MCPE Maps for Minecraft Bedrock Edition. Adventure maps, parkour maps, survival maps, puzzle maps and more.">
    <meta property="twitter:image" content="https://www.pvcraft.net/home/imgs/home.jpg">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.pvcraft.net/maps/">
    
    <!-- Schema.org markup for Google -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "CollectionPage",
      "name": "MCPE Maps - PVCRAFT",
      "description": "Download free MCPE Maps for Minecraft Bedrock Edition. Adventure maps, parkour maps, survival maps, puzzle maps and more.",
      "url": "https://www.pvcraft.net/maps/",
      "mainEntity": {
        "@type": "ItemList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Adventure Maps",
            "url": "https://www.pvcraft.net/maps/adventure"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Parkour Maps",
            "url": "https://www.pvcraft.net/maps/parkour"
          },
          {
            "@type": "ListItem",
            "position": 3,
            "name": "Survival Maps",
            "url": "https://www.pvcraft.net/maps/survival"
          },
          {
            "@type": "ListItem",
            "position": 4,
            "name": "Puzzle Maps",
            "url": "https://www.pvcraft.net/maps/puzzle"
          },
          {
            "@type": "ListItem",
            "position": 5,
            "name": "Mini-Game Maps",
            "url": "https://www.pvcraft.net/maps/minigame"
          }
        ]
      },
      "publisher": {
        "@type": "Organization",
        "name": "PVCRAFT",
        "logo": {
          "@type": "ImageObject",
          "url": "https://www.pvcraft.net/home/imgs/logo.png"
        }
      }
    }
    </script>
    
    <!-- Breadcrumb Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://www.pvcraft.net/"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Maps",
          "item": "https://www.pvcraft.net/maps/"
        }
      ]
    }
    </script>

    <!-- Fontes e ícones -->
 <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="/home/global.css" as="style">
    
    <link rel="preload" href="https://fonts.cdnfonts.com/css/minecrafter-alt" as="style" crossorigin="anonymous">
    
    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/home/imgs/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/home/imgs/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/home/imgs/favicon-16x16.png">
    <link rel="manifest" href="/home/imgs/site.webmanifest">

    <!-- Estilos -->
    <link rel="stylesheet" href="/home/global.css">
    <link rel="stylesheet" href="/home/ads.css">
    
    <!-- ✅ CORREÇÃO 1: Script do Google AdSense APENAS UMA VEZ no head -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8023784976492432"
        crossorigin="anonymous"></script>
   <style>
/* Page Titles com fontes grossas */
.page-title {
    font-size: 42px;
    color: #262423;
    text-align: center;
    font-weight: 900;
    font-family: "Rajdhani", sans-serif;
    margin-bottom: 20px;
}

/* Estilos para data e views nos cards - COR BRANCA */
.content-meta {
    display: flex;
    justify-content: space-between;
    margin: 8px 0;
    font-size: 12px;
    color: #ffffff; /* BRANCO */
}

.content-date, .content-views {
    font-weight: 500;
    color: #ffffff; /* BRANCO */
}

/* Ajustes para os cards de conteúdo */
.conteudo {
    position: relative;
}

.conteudo .descricao-curta {
    margin: 8px 0;
    line-height: 1.4;
    color: #ffffff; /* Garantir que a descrição também seja branca */
}

.conteudo .autor {
    margin: 4px 0;
    color: #ffffff; /* Garantir que o autor também seja branco */
}

/* NOVOS ESTILOS PARA ANÚNCIOS */
.ad-container {
    margin: 20px 0;
    text-align: center;
    background: transparent;
    position: relative;
}

.ad-label {
    position: absolute !important;
    height: 1px !important;
    width: 1px !important;
    overflow: hidden !important;
    clip: rect(1px, 1px, 1px, 1px) !important;
    white-space: nowrap !important;
    font-size: 1px !important;
    color: transparent !important;
    background: transparent !important;
    border: none !important;
    padding: 0 !important;
    margin: -1px !important;
}

/* Anúncios laterais verticais */
.sidebar-ads {
    position: fixed;
    top: 50%;
    transform: translateY(-50%);
    width: 160px;
    z-index: 100;
}

.sidebar-left {
    left: 10px;
}

.sidebar-right {
    right: 10px;
}

.sidebar-ad-container {
    margin-bottom: 20px;
    background: transparent;
    min-height: 600px;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

/* Anúncios horizontais entre cards */
.horizontal-ad {
    width: 100%;
    margin: 30px 0;
    min-height: 90px;
    display: flex;
    justify-content: center;
    align-items: center;
}

/* Anúncio no topo (após o título) */
.top-ad {
    margin: 20px 0 30px 0;
    min-height: 90px;
}

/* Anúncio no rodapé */
.footer-ad {
    margin: 30px 0 20px 0;
    min-height: 90px;
}

/* LAYOUT PRINCIPAL - APENAS LARGURA AUMENTADA */
.content-container {
    max-width: 1250px; /* Aumentado de 1200px para 1250px */
    margin: 0 auto;
    padding: 0 10px; /* Aumentado de 200px para 210px */
    position: relative;
}

/* Grid de conteúdo */
.content-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 25px;
    width: 100%;
}

/* CARDS - APENAS LARGURA AUMENTADA */
.conteudo {
    width: 100%;
    max-width: 370px; /* Aumentado de 350px para 370px */
    margin: 0 auto;
}

/* Garantir que todos os cards tenham a mesma altura */
.conteudo a {
    display: flex;
    flex-direction: column;
    height: 100%;
}

/* IMAGENS COM PROPORÇÃO 16:9 */
.conteudo .imagem {
    flex-shrink: 0;
    width: 100%;
    aspect-ratio: 16 / 9; /* PROPORÇÃO 16:9 */
    object-fit: cover; /* Garante que a imagem preencha o espaço mantendo a proporção */
    border-radius: 4px;
}

.conteudo .titulo {
    flex-grow: 0;
    font-size: 18px;
    min-height: 50px;
    display: flex;
    align-items: center;
    margin: 10px 0 5px 0;
}

.conteudo .descricao-curta {
    flex-grow: 1;
    font-size: 14px;
    min-height: 60px;
    margin: 5px 0;
}

.conteudo .autor {
    margin: 5px 0;
    font-size: 13px;
}

.conteudo .tipo {
    margin-top: 8px;
}

/* Responsividade */
@media (max-width: 768px) {
    .content-meta {
        font-size: 11px;
    }
    
    .sidebar-ads {
        display: none; /* Esconder anúncios laterais no mobile */
    }
    
    .content-container {
        padding: 0 15px; /* Remover padding lateral no mobile */
    }
    
    .horizontal-ad {
        margin: 20px 0;
        min-height: 70px;
    }
    
    .top-ad, .footer-ad {
        min-height: 70px;
    }
    
    .content-grid {
        grid-template-columns: repeat(2, 1fr); /* 2 colunas no mobile */
        gap: 20px;
    }
    
    .conteudo {
        max-width: 100%;
    }
    
    /* Mobile: manter proporção 16:9 */
    .conteudo .imagem {
        aspect-ratio: 16 / 9;
    }
    
    .conteudo .titulo {
        font-size: 16px;
        min-height: 45px;
    }
    
    .conteudo .descricao-curta {
        font-size: 13px;
        min-height: 55px;
    }
}

@media (min-width: 769px) and (max-width: 1200px) {
    .sidebar-ads {
        width: 160px;
    }
    
    .content-container {
        padding: 0 190px; /* Ajustado para tablet */
        max-width: 1150px; /* Ajustado para tablet */
    }
    
    .content-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 22px;
    }
    
    .conteudo {
        max-width: 330px; /* Ajustado para tablet */
    }
    
    /* Tablet: manter proporção 16:9 */
    .conteudo .imagem {
        aspect-ratio: 16 / 9;
    }
}

@media (max-width: 480px) {
    .content-grid {
        grid-template-columns: 1fr; /* 1 coluna em telas muito pequenas */
        gap: 15px;
    }
    
    /* Mobile pequeno: manter proporção 16:9 */
    .conteudo .imagem {
        aspect-ratio: 16 / 9;
    }
    
    .conteudo .titulo {
        font-size: 15px;
        min-height: 40px;
    }
    
    .conteudo .descricao-curta {
        font-size: 12px;
        min-height: 50px;
    }
}

/* Fallback para navegadores que não suportam aspect-ratio */
@supports not (aspect-ratio: 16 / 9) {
    .conteudo .imagem {
        height: 0;
        padding-bottom: 56.25%; /* 16:9 aspect ratio (9/16 = 0.5625) */
        position: relative;
    }
    
    .conteudo .imagem img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
}
</style>
</head>

<body>
    <!-- Modal de Login (ADICIONADO) -->
    <div class="login-modal" id="loginModal">
        <div class="login-box">
            <button class="close-login" id="closeLogin">&times;</button>
            <h2 class="login-title">LOGIN WITH GOOGLE</h2>
            <p style="color: #262423; margin-bottom: 20px;">Access your PVCRAFT account with your Google account</p>
            <button class="google-login-btn" id="googleLoginBtn">
                <svg class="google-icon" viewBox="0 0 24 24" width="20" height="20" xmlns="http://www.w3.org/2000/svg">
                    <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                    <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                    <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                    <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                </svg>
                Sign in with Google
            </button>
        </div>
    </div>

    <nav class="navbar">
        <div class="navbar-container">
             <a href="/index.html" class="logo">
 <img src="https://i.imghippo.com/files/mxP2154az.png" width="150px" alt="PVCRAFT Logo" draggable="false"></a>
            <div class="search-container">
                <form id="searchForm" action="/home/search.html" method="get">
                    <input type="text" id="pesquisa" name="q" placeholder="Search maps...">
                    <button type="submit" id="searchButton"><i class="fas fa-search"></i></button>
                </form>
            </div>
            <div class="hamburger" id="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
           <ul class="nav-menu" id="navMenu">
                <li><a href="/index.html">HOME</a></li>
                <li><a href="/addons/index.html">ADDONS</a></li>
                <li><a href="/maps/index.html">MAPS</a></li>
                <li><a href="/textures/index.html">TEXTURES</a></li>
                <!-- ITENS DE LOGIN ADICIONADOS -->
                <li><a href="#" id="loginLink">LOGIN</a></li>
                <li class="user-profile" id="userProfile">
                    <div class="user-avatar" id="userAvatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <span class="user-name desktop" id="userNameDesktop"></span>
                    <span class="user-name mobile" id="userNameMobile"></span>
                    
                    <!-- Dropdown Menu -->
                    <div class="user-dropdown" id="userDropdown">
                        <div class="dropdown-header">
                            <span class="user-name" id="dropdownUserName"></span>
                        </div>
                        <a href="/submission/index.html" class="dropdown-item">
                            <i class="fas fa-upload"></i>SUBMISSION
                        </a>
                        <button class="dropdown-item" id="dropdownLogoutBtn">
                            <i class="fas fa-sign-out-alt"></i>LOGOUT
                        </button>
                    </div>
                </li>
            </ul>
        </div>
    </nav>

    <main class="content-container">
          <div class="flx-container">
            <div class="">
                <div class="box-ads">
                    <!-- side-vertical -->
                    <ins class="adsbygoogle"
                    style="display:block"
                    data-ad-client="ca-pub-8023784976492432"
                    data-ad-slot="6872905425"
                    data-ad-format="auto"
                    data-full-width-responsive="true">
                    </ins>
                </div>
                <div class="box-ads">
                    <!-- side-vertical -->
                    <ins class="adsbygoogle"
                    style="display:block"
                    data-ad-client="ca-pub-8023784976492432"
                    data-ad-slot="6872905425"
                    data-ad-format="auto"
                    data-full-width-responsive="true">
                    </ins>
                </div>
            </div>

            <div class="mycontent">
                <h1 class="page-title">MCPE MAPS</h1>

                <!-- Filtro Dropdown (Ordenação) -->
                <div style="display: flex; justify-content: flex-end; margin: 20px 0;">
                    <div style="display: flex; align-items: center;">
                        <span style="color: #262423; margin-right: 10px; font-family: 'Minecrafter', sans-serif;">Sort by:</span>
                        <select id="sortDropdown" style="background-color: #5ca83e; color: #262423; border: 2px solid #262423; padding: 10px 15px; font-family: 'Minecrafter', sans-serif; cursor: pointer; border-radius: 4px;">
                            <option value="recent">Most Recent</option>
                            <option value="popular">Most Popular</option>
                        </select>
                    </div>
                </div>

                <section class="content-section" style="min-height: 500px;">
                    <div class="content-grid" id="maps-grid">
                        <div class="loading">
                            <i class="fas fa-circle-notch fa-spin"></i> Loading Maps...
                        </div>
                    </div>
                </section>
                
                <div class="box-ads mob"> 
                    <!-- horizontal -->
                    <ins class="adsbygoogle"
                    style="display:block"
                    data-ad-client="ca-pub-8023784976492432"
                    data-ad-slot="1339601043"
                    data-ad-format="auto"
                    data-full-width-responsive="true">
                    </ins>
                </div>
                
                <section class="pagination-container">
                    <div class="pagination" id="pagination">
                        <!-- Os botões de paginação serão gerados aqui dinamicamente -->
                    </div>
                </section>
            </div>

            <div class="">
                <div class="box-ads">
                    <!-- side-vertical -->
                    <ins class="adsbygoogle"
                    style="display:block"
                    data-ad-client="ca-pub-8023784976492432"
                    data-ad-slot="6872905425"
                    data-ad-format="auto"
                    data-full-width-responsive="true">
                    </ins>
                </div>
                <div class="box-ads">
                    <!-- side-vertical -->
                    <ins class="adsbygoogle"
                    style="display:block"
                    data-ad-client="ca-pub-8023784976492432"
                    data-ad-slot="6872905425"
                    data-ad-format="auto"
                    data-full-width-responsive="true">
                    </ins>
                </div>
            </div>
        </div>
    </main>

    <!-- Rodapé -->
    <div class="content-container">
        <div class="box-ads mob">
            <!-- footer-horzt -->
            <ins class="adsbygoogle"
                style="display:block"
                data-ad-client="ca-pub-8023784976492432"
                data-ad-slot="1339601043"
                data-ad-format="auto"
                data-full-width-responsive="true"></ins>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-links">
            <a href="/terms/index.html">Terms of use</a>
            <a href="/privacy/index.html">Privacy</a>
            <a href="/contact/index.html">Contact us</a>
        </div>
        <div class="social-icons">
            <a href="https://discord.com/invite/CNDkVUp5wX" class="social-icon">
                <i class="fab fa-discord"></i>
            </a>
            <a href="https://www.youtube.com/@pedrovisquicreations" class="social-icon">
                <i class="fab fa-youtube"></i>
            </a>
        </div>
        <div class="footer-info">
            <p>©2025 PVCRAFT.net. All rights reserved.</p>
            <p class="disclaimer">Not affiliated with Mojang or Microsoft. Minecraft is a trademark of Mojang Studios.  
            Community creations shared with permission.</p>
        </div>
    </footer>

    <!-- Firebase SDK v9 (Modular) -->
    <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js";
    import {
        getFirestore,
        collection,
        getDocs,
        query,
        where
    } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyA_9XH-WhFFvs4F9YtBkDnMMS6vvc49wtg",
        authDomain: "pvcraftsite.firebaseapp.com",
        projectId: "pvcraftsite",
        storageBucket: "pvcraftsite.appspot.com",
        messagingSenderId: "172479486134",
        appId: "1:172479486134:web:dfd3248b4be5de5748ae17"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Função para converter data no formato MM/DD/YYYY para timestamp (MESMO DA PÁGINA HOME)
    function convertDateToTimestamp(dateString) {
        if (!dateString || dateString.trim() === '') {
            return 0; // Retorna 0 para datas vazias (serão ordenadas no final)
        }
        
        try {
            // Tenta diferentes formatos de data
            let date;
            
            // Formato MM/DD/YYYY
            if (dateString.includes('/')) {
                const parts = dateString.split('/');
                if (parts.length === 3) {
                    const month = parseInt(parts[0]) - 1; // Mês é 0-indexed
                    const day = parseInt(parts[1]);
                    const year = parseInt(parts[2]);
                    date = new Date(year, month, day);
                }
            } 
            // Formato YYYY-MM-DD (formato ISO)
            else if (dateString.includes('-')) {
                date = new Date(dateString);
            }
            // Tenta parse direto
            else {
                date = new Date(dateString);
            }
            
            // Verifica se a data é válida
            if (date instanceof Date && !isNaN(date.getTime())) {
                return date.getTime();
            }
        } catch (error) {
            console.error('Error converting date:', error, 'Date string:', dateString);
        }
        
        // Se não conseguiu converter, retorna 0
        return 0;
    }

    // Função para gerar data aleatória entre 01/01/2021 e 11/03/2025
    function generateRandomDate() {
        const startDate = new Date('2021-01-01');
        const endDate = new Date('2025-03-11');
        const randomTime = startDate.getTime() + Math.random() * (endDate.getTime() - startDate.getTime());
        const randomDate = new Date(randomTime);
        
        // Formatar como MM/DD/YYYY
        const month = String(randomDate.getMonth() + 1).padStart(2, '0');
        const day = String(randomDate.getDate()).padStart(2, '0');
        const year = randomDate.getFullYear();
        
        return `${month}/${day}/${year}`;
    }

    // Função para gerar views aleatórias entre 0 e 30000
    function generateRandomViews() {
        return Math.floor(Math.random() * 30001); // 0 a 30000
    }

    // Função para formatar números com separadores de milhar
    function formatNumber(num) {
        return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    // Variáveis globais
    let allMaps = [];
    let filteredMaps = [];
    const itemsPerPage = 12;
    let currentSort = 'recent'; // Padrão: Most Recent
    let currentPage = 1;

    /**
     * Carrega os maps com paginação
     */
    async function loadMaps(page = 1) {
        try {
            const grid = document.getElementById('maps-grid');
            const pagination = document.getElementById('pagination');

            grid.innerHTML = '<div class="loading"><i class="fas fa-circle-notch fa-spin"></i> Loading Maps...</div>';
            pagination.innerHTML = '';

            // Se ainda não carregamos todos os maps, busca do Firebase
            if (allMaps.length === 0) {
                const q = query(collection(db, "maps"), where("tipo", "==", "map"));
                const querySnapshot = await getDocs(q);

                if (querySnapshot.empty) {
                    grid.innerHTML = '<p class="error-message">No maps found.</p>';
                    return;
                }

                // Coletar todos os maps
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    
                    // Processar data e views
                    const contentDate = data.data || generateRandomDate();
                    const contentViews = data.views !== undefined ? data.views : generateRandomViews();
                    const formattedViews = formatNumber(contentViews);
                    
                    // USANDO O MESMO SISTEMA DA PÁGINA HOME: Converter data para timestamp
                    const timestamp = convertDateToTimestamp(contentDate);
                    
                    allMaps.push({
                        id: doc.id,
                        // USANDO O MESMO SISTEMA DA PÁGINA HOME
                        timestamp: timestamp,
                        views: data.views || Math.floor(Math.random() * 1000),
                        contentDate: contentDate,
                        formattedViews: formattedViews,
                        ...data
                    });
                });
            }

            // Aplica o filtro de ordenação
            applySort();

            // Exibe os maps ou mensagem de erro
            if (filteredMaps.length === 0) {
                grid.innerHTML = '<p class="error-message">No maps found.</p>';
                return;
            }

            // Calculate pagination totals
            const totalItems = filteredMaps.length;
            const totalPages = Math.ceil(totalItems / itemsPerPage);

            // Limit current page to maximum available
            currentPage = Math.min(page, totalPages);

            // Get items for current page
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageMaps = filteredMaps.slice(startIndex, endIndex);

            // Clear grid and add cards
            grid.innerHTML = '';

            if (pageMaps.length === 0) {
                grid.innerHTML = '<p class="error-message">No maps found for this page.</p>';
                return;
            }

            // Adicionar cards com anúncios horizontais a cada 6 cards (2 linhas)
            let cardCount = 0;
            for (let i = 0; i < pageMaps.length; i++) {
                const map = pageMaps[i];
                const card = document.createElement('article');
                card.className = 'conteudo';
                card.innerHTML = createMapCardHTML(map);
                grid.appendChild(card);
                
                cardCount++;
                
                // Adicionar anúncio horizontal a cada 6 cards (2 linhas de 3 cards)
                if (cardCount % 6 === 0 && i < pageMaps.length - 1) {
                    const adContainer = document.createElement('div');
                    adContainer.className = 'ad-container horizontal-ad';
                    adContainer.style.gridColumn = '1 / -1'; // Garantir que ocupe toda a largura
                    adContainer.innerHTML = ` 
                    <div class="box-ads mob"> 
                        <!-- horizontal -->
                        <ins class="adsbygoogle"
                            style="display:block"
                            data-ad-client="ca-pub-8023784976492432"
                            data-ad-slot="1339601043"
                            data-ad-format="auto"
                            data-full-width-responsive="true">
                        </ins>
                    </div>
                    `;
                    grid.appendChild(adContainer);
                    try {
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    } catch (e) {
                        console.warn("Erro ao renderizar anúncio:", e);
                    }
                }
            }

            // Create pagination (if needed)
            if (totalPages > 1) {
                createPagination(totalPages, currentPage);
            }

        } catch (error) {
            console.error("Error loading maps:", error);
            document.getElementById('maps-grid').innerHTML =
                '<p class="error-message">Error loading maps. Please reload the page.</p>';
        }
    }

    /**
     * Cria o HTML para um card de map
     */
    function createMapCardHTML(map) {
        // Usar data e views processadas
        const contentDate = map.contentDate || generateRandomDate();
        const formattedViews = map.formattedViews || formatNumber(generateRandomViews());

        return `
            <a href="/maps/index.php?id=${map.id}" class="map-link">
                <img src="${map.imagem}" alt="${map.titulo}" class="imagem" onerror="this.src='/home/imgs/default.jpg'">
                <h2 class="titulo">${map.titulo}</h2>
                
                <!-- Data e Views - COR BRANCA -->
                <div class="content-meta">
                    <span class="content-date">${contentDate}</span>
                    <span class="content-views">${formattedViews} views</span>
                </div>
                
                <p class="descricao-curta">${map.descricaoCurta}</p>
                <p class="autor">${map.autor}</p>
                <div class="tipo">MAP</div>
            </a>
        `;
    }

    /**
     * Aplica a ordenação selecionada aos maps - USANDO O MESMO SISTEMA DA PÁGINA HOME
     */
    function applySort() {
        switch(currentSort) {
            case 'recent':
                // USANDO O MESMO SISTEMA DA PÁGINA HOME: Ordenar por timestamp (mais recentes primeiro)
                filteredMaps = [...allMaps].sort((a, b) => {
                    const timeA = a.timestamp || 0;
                    const timeB = b.timestamp || 0;
                    return timeB - timeA; // Mais recente primeiro (maior timestamp)
                });
                break;
                
            case 'popular':
                // Ordena por visualizações (mais populares primeiro)
                filteredMaps = [...allMaps].sort((a, b) => {
                    const viewsA = a.views || 0;
                    const viewsB = b.views || 0;
                    return viewsB - viewsA;
                });
                break;
                
            default:
                filteredMaps = [...allMaps];
                break;
        }
    }

    /**
     * Cria os botões de paginação
     */
    function createPagination(totalPages, currentPage) {
        const pagination = document.getElementById('pagination');
        pagination.innerHTML = '';

        // Previous Button
        const prevButton = document.createElement('button');
        prevButton.innerText = 'Previous';
        prevButton.className = 'pagination-button';
        prevButton.disabled = currentPage === 1;
        if (currentPage === 1) {
            prevButton.classList.add('disabled');
        }
        prevButton.addEventListener('click', () => {
            if (currentPage > 1) {
                loadMaps(currentPage - 1);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        });
        pagination.appendChild(prevButton);

        // Page Number Buttons
        const maxVisibleButtons = 5;
        let startPage, endPage;

        if (totalPages <= maxVisibleButtons) {
            // Show all pages
            startPage = 1;
            endPage = totalPages;
        } else {
            // Calculate which pages to show
            const maxButtonsBeforeCurrent = Math.floor(maxVisibleButtons / 2);
            const maxButtonsAfterCurrent = Math.ceil(maxVisibleButtons / 2) - 1;

            if (currentPage <= maxButtonsBeforeCurrent) {
                // Current page near the start
                startPage = 1;
                endPage = maxVisibleButtons;
            } else if (currentPage + maxButtonsAfterCurrent >= totalPages) {
                // Current page near the end
                startPage = totalPages - maxVisibleButtons + 1;
                endPage = totalPages;
            } else {
                // Current page in the middle
                startPage = currentPage - maxButtonsBeforeCurrent;
                endPage = currentPage + maxButtonsAfterCurrent;
            }
        }

        // Add number buttons
        for (let i = startPage; i <= endPage; i++) {
            const pageButton = document.createElement('button');
            pageButton.innerText = i;
            pageButton.className = 'pagination-button';
            if (i === currentPage) {
                pageButton.classList.add('active');
            }
            pageButton.addEventListener('click', () => {
                loadMaps(i);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
            pagination.appendChild(pageButton);
        }

        // Next Button
        const nextButton = document.createElement('button');
        nextButton.innerText = 'Next';
        nextButton.className = 'pagination-button';
        nextButton.disabled = currentPage === totalPages;
        if (currentPage === totalPages) {
            nextButton.classList.add('disabled');
        }
        nextButton.addEventListener('click', () => {
            if (currentPage < totalPages) {
                loadMaps(currentPage + 1);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        });
        pagination.appendChild(nextButton);
    }

    // Configura o filtro dropdown (ordenação)
    function setupSortDropdown() {
        const dropdown = document.getElementById('sortDropdown');
        
        dropdown.addEventListener('change', () => {
            currentSort = dropdown.value;
            applySort();
            loadMaps(1); // Recarrega na primeira página
        });
    }

    // SISTEMA DE LOGIN (ADICIONADO)
    function setupGoogleLogin() {
        const loginModal = document.getElementById('loginModal');
        const loginLink = document.getElementById('loginLink');
        const closeLogin = document.getElementById('closeLogin');
        const googleLoginBtn = document.getElementById('googleLoginBtn');
        const userProfile = document.getElementById('userProfile');
        const userNameDesktop = document.getElementById('userNameDesktop');
        const userNameMobile = document.getElementById('userNameMobile');
        const userAvatar = document.getElementById('userAvatar');
        const userDropdown = document.getElementById('userDropdown');
        const dropdownUserName = document.getElementById('dropdownUserName');
        const dropdownLogoutBtn = document.getElementById('dropdownLogoutBtn');

        // SEU CLIENT ID REAL
        const GOOGLE_CLIENT_ID = '537384979447-535gub67h9846su9gl63h9j18332japp.apps.googleusercontent.com';
        
        // Verificar se usuário já está logado
        checkUserLogin();

        // Abrir modal de login
        loginLink.addEventListener('click', (e) => {
            e.preventDefault();
            loginModal.classList.add('active');
        });

        // Fechar modal de login
        closeLogin.addEventListener('click', () => {
            loginModal.classList.remove('active');
        });

        // Fechar modal ao clicar fora
        loginModal.addEventListener('click', (e) => {
            if (e.target === loginModal) {
                loginModal.classList.remove('active');
            }
        });

        // Login com Google
        googleLoginBtn.addEventListener('click', () => {
            iniciarLoginGoogle();
        });

        // Controle do Dropdown
        let dropdownTimeout;

        // Desktop: Hover
        if (window.innerWidth >= 769) {
            userProfile.addEventListener('mouseenter', () => {
                clearTimeout(dropdownTimeout);
                userDropdown.classList.add('active');
            });
            
            userProfile.addEventListener('mouseleave', (e) => {
                dropdownTimeout = setTimeout(() => {
                    if (!userProfile.contains(e.relatedTarget) && !userDropdown.contains(e.relatedTarget)) {
                        userDropdown.classList.remove('active');
                    }
                }, 100);
            });

            userDropdown.addEventListener('mouseenter', () => {
                clearTimeout(dropdownTimeout);
            });

            userDropdown.addEventListener('mouseleave', (e) => {
                dropdownTimeout = setTimeout(() => {
                    if (!userProfile.contains(e.relatedTarget) && !userDropdown.contains(e.relatedTarget)) {
                        userDropdown.classList.remove('active');
                    }
                }, 100);
            });
        }

        // Mobile: Click
        userAvatar.addEventListener('click', (e) => {
            e.stopPropagation();
            userDropdown.classList.toggle('active');
        });

        // Fechar dropdown ao clicar fora
        document.addEventListener('click', (e) => {
            if (!userProfile.contains(e.target) && !userDropdown.contains(e.target)) {
                userDropdown.classList.remove('active');
            }
        });

        // Fechar dropdown quando um item for clicado (mobile)
        userDropdown.addEventListener('click', (e) => {
            if (window.innerWidth < 769) {
                userDropdown.classList.remove('active');
            }
        });

        // Função para iniciar login com Google
        function iniciarLoginGoogle() {
            // ✅ REDIRECIONA PARA A MESMA PÁGINA (maps)
            const currentUrl = window.location.href;
            
            const authUrl = `https://accounts.google.com/o/oauth2/v2/auth?` +
                `client_id=${GOOGLE_CLIENT_ID}&` +
                `redirect_uri=${encodeURIComponent(currentUrl)}&` +
                `response_type=token&` +
                `scope=email%20profile&` +
                `include_granted_scopes=true&` +
                `state=pvcraft_site`;

            window.location.href = authUrl;
        }

        // Verificar se há resposta do Google na URL
        function checkGoogleResponse() {
            const hash = window.location.hash.substring(1);
            const params = new URLSearchParams(hash);
            const accessToken = params.get('access_token');

            if (accessToken) {
                fetch('https://www.googleapis.com/oauth2/v1/userinfo?alt=json', {
                    headers: {
                        'Authorization': `Bearer ${accessToken}`
                    }
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(userInfo => {
                    const userData = {
                        name: userInfo.name || 'Google User',
                        email: userInfo.email,
                        avatar: userInfo.picture,
                        id: userInfo.id,
                        hasPhoto: !!userInfo.picture
                    };

                    localStorage.setItem('pvcraftUser', JSON.stringify(userData));
                    localStorage.setItem('googleAccessToken', accessToken);
                    
                    showUserProfile(userData);
                    
                    // Limpar URL
                    window.history.replaceState({}, document.title, window.location.pathname);
                })
                .catch(error => {
                    console.error('❌ Error during login:', error);
                    alert('Error during login. Please try again.');
                });
            }
        }

        // Verificar se usuário está logado
        function checkUserLogin() {
            const savedUser = localStorage.getItem('pvcraftUser');
            if (savedUser) {
                try {
                    const user = JSON.parse(savedUser);
                    showUserProfile(user);
                } catch (e) {
                    localStorage.removeItem('pvcraftUser');
                }
            } else {
                userProfile.style.display = 'none';
                loginLink.style.display = 'block';
            }
            
            checkGoogleResponse();
        }

        // Logout
        dropdownLogoutBtn.addEventListener('click', () => {
            localStorage.removeItem('pvcraftUser');
            localStorage.removeItem('googleAccessToken');
            userProfile.style.display = 'none';
            loginLink.style.display = 'block';
            userDropdown.classList.remove('active');
            loginModal.classList.remove('active');
        });

        function showUserProfile(user) {
            if (user.hasPhoto && user.avatar) {
                userAvatar.innerHTML = '';
                userAvatar.style.backgroundImage = `url(${user.avatar})`;
                userAvatar.style.backgroundSize = 'cover';
                userAvatar.style.backgroundPosition = 'center';
                userAvatar.classList.add('has-photo');
            } else {
                userAvatar.innerHTML = '<i class="fas fa-user"></i>';
                userAvatar.style.backgroundImage = 'none';
                userAvatar.classList.remove('has-photo');
            }
            
            userNameDesktop.textContent = user.name;
            userNameMobile.textContent = user.name;
            dropdownUserName.textContent = user.name;
            
            userProfile.style.display = 'flex';
            loginLink.style.display = 'none';
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        // Get page number from URL (e.g., ?page=2)
        const urlParams = new URLSearchParams(window.location.search);
        const pageParam = urlParams.get('page');
        const initialPage = pageParam ? parseInt(pageParam) : 1;

        // Configura o filtro dropdown
        setupSortDropdown();
        
        // Carrega os maps
        loadMaps(initialPage);

        // Configura o sistema de login
        setupGoogleLogin();

        // Hamburger menu control
        const hamburger = document.getElementById('hamburger');
        const navMenu = document.getElementById('navMenu');
        if (hamburger) {
            hamburger.addEventListener('click', () => {
                hamburger.classList.toggle('active');
                navMenu.classList.toggle('active');
            });
        }
    });
    </script>

    <!-- ✅ Script  -->
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        (adsbygoogle = window.adsbygoogle || []).push({});
        (adsbygoogle = window.adsbygoogle || []).push({});
        (adsbygoogle = window.adsbygoogle || []).push({});
        (adsbygoogle = window.adsbygoogle || []).push({});
        (adsbygoogle = window.adsbygoogle || []).push({});
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</body>
</html>